<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <audio id="notification_sound">
        <source src="https://rmservices.duckdns.org/files/notification-sound.ogg" type="audio/mpeg">
        <source src="https://rmservices.duckdns.org/files/notification-sound.mp3" type="audio/ogg">
      </audio>
        <div class="popup-container hide">
            <div id="confirmation" class="popup">
                <p></p>
                <div>
                    <button class="hover" onclick="hidePopup(this)">Cancel</button>
                    <button class="hover">Ok</button>
                </div>
            </div>
        </div>
        <div id="show_message" class="hide">
          <svg id="error_icon" class="notification-icon hide-completely" viewBox="0 0 100 100">
            <title>Error icon</title>
            <path d="M50,0a50,50,0,1,0,50,50A50,50,0,0,0,50,0ZM46,27.18A.79.79,0,0,1,46.6,27h7.72a.79.79,0,0,1,.79.79l-1,28.76a.79.79,0,0,
            1-.79.79H47.46a.77.77,0,0,1-.56-.23.73.73,0,0,1-.23-.56l-.86-28.76A.77.77,0,0,1,46,27.18Zm7.68,44.39A4.91,4.91,0,0,1,50,73.05a5.08,5.08,
            0,0,1-5.21-5.21A5,5,0,0,1,50,62.63a5,5,0,0,1,3.73,1.45,5.18,5.18,0,0,1,1.42,3.76A5.11,5.11,0,0,1,53.72,71.57Z"/>
          </svg>
          <svg id="done_icon" class="notification-icon" viewBox="0 0 100 100">
            <title>Done icon</title>
            <path d="M50,0a50,50,0,1,0,50,50A50,50,0,0,0,50,0ZM80.85,32.37,40.3,72.92a1.24,1.24,0,0,1-1.75,0l-19.4-19.4a1.23,1.23,0,0,1,0-1.75l3.54-3.54a1.23,
            1.23,0,0,1,1.74,0L38.55,62.35a1.24,1.24,0,0,0,1.75,0L75.57,27.08a1.23,1.23,0,0,1,1.74,0l3.54,3.54A1.23,1.23,0,0,1,80.85,32.37Z"/>
          </svg>
          <div>
            <h5>Notification</h5>
            <span id="notification_text">Message</span>
          </div>
            <button id="hide_banner_btn">
            <svg viewBox="0 0 50 50">
                <title>Close this notification</title>
                <line x1="50" y1="0" x2="0" y2="50"/>
                <line x1="0" y1="0" x2="50" y2="50"/>
            </svg>
            </button>
        </div>
        <div class="popup-container solid-background hide">
            <div id="sign_in_popup" class="popup">
                <div class="container-header">
                    <h1>Sign In</h1>
                </div>
                <p class="expand light-text">Welcome to RanchiMall Crypto exchange <b>Local Bitcoin++</b></p>
                <form class="expand" autocomplete="off" onsubmit="return false">
                    <div class="input">
                        <input id="get_priv_key_field" type="password" required>
                        <label>Private Key</label>
                      </div>
                    <div class="action expand" onclick="signIn(this)">
                      <button class="primary-btn expand" type="button" disabled>
                          Sign In
                      </button>
                      <svg viewBox="0 0 73 73" class="loader">
                          <path d="M72.5,36.5c0,19.88-16.12,36-36,36s-36-16.12-36-36s16.12-36,36-36S72.5,16.62,72.5,36.5"/>
                      </svg>
                    </div>
                </form>
                <p class="light-text">
                    Don't have private key, get it from <a href="https://flo-webwallet.duckdns.org/" target="_blank">here</a>.
                </p>
                <svg id="sign_in_illustration" viewBox="0 0 612 276.03">
                  <defs><style>.a{fill:#ee2a7b;}.b{fill:#9e1f63;}.c{fill:#da1c5c;}</style></defs>
                  <title>Untitled-1</title>
                  <polygon class="a" points="0 0 0 276.03 195.07 207.16 233.66 0 0 0"/>
                  <polygon class="b" points="114.09 0 117.19 27.93 356.1 132.63 536.42 0 114.09 0"/>
                  <polygon class="c" points="480.49 0 538.11 99.8 612 99.8 612 0 480.49 0"/>
                </svg>
            </div>
          </div> 
    <header id="main_header" class="flex">
        <svg viewBox="0 0 180 105.7" class="hide-completely">
            <path d="M22.5,35.5C27.7,32.6,33.6,31,40,31c19.9,0,36,16.1,36,36c0,16.6-11.2,30.6-26.5,34.7"/>
            <path d="M4,4v63c0,16.2,10.7,30,25.5,34.4"/>
            <line x1="94" y1="67.1" x2="126" y2="67.1"/>
            <line x1="110" y1="50.5" x2="110" y2="83.8"/>
            <line x1="144" y1="67.1" x2="176" y2="67.1"/>
            <line x1="160" y1="50.5" x2="160" y2="83.8"/>
        </svg>
        <span>
            <h5>RanchiMall</h5>
            <h3>Local Bitcoin++</h3>
        </span>

    </header>
    <nav id="navbar">
        <div title="See all cash deposit requests" id="deposit_page_btn" class="navbar-item active notification-dot" onclick="showPage(this, 'deposit')">
            <svg class="icon banking" viewBox="0 0 52 51.5">
                <title>deposit icon</title>
                <line x1="4" y1="28" x2="4" y2="19.5"/>
                <polyline points="4 6 4 1 51 1 51 48 4 48 4 41.5"/>
                <line x1="9" y1="50" x2="18" y2="50"/>
                <line x1="36" y1="50" x2="45" y2="50"/>
                <circle cx="27.5" cy="30" r="9.5"/>
                <circle cx="27.5" cy="30" r="3.5"/>
                <rect x="1" y="6" width="6" height="13.5" rx="2.76"/>
                <rect x="1" y="28" width="6" height="13.5" rx="2.76"/>
            </svg>
            <h5>Deposit</h5>
        </div>
        <div title="See all cash withdraw requests" class="navbar-item notification-dot" onclick="showPage(this, 'withdraw')">
            <svg class="icon banking" viewBox="0 0 52 60">
                <title>withdraw icon</title>
                <line x1="4" y1="33.5" x2="4" y2="25"/>
                <polyline points="41.52 6.5 51 6.5 51 53.5 41.69 53.5"/>
                <line x1="9" y1="55.5" x2="14" y2="55.5"/>
                <line x1="43" y1="55.5" x2="45" y2="55.5"/>
                <rect x="1" y="11.5" width="6" height="13.5" rx="2.76"/>
                <rect x="1" y="33.5" width="6" height="13.5" rx="2.76"/>
                <polyline points="3.81 11.5 3.81 6.5 41.5 1 41.69 59 3.81 53.5 3.81 47"/>
                <path d="M35.64,39.19c0,6.31-3.25,11.45-7.22,11.48s-7-4.92-7-11.07,3.13-11.29,7.05-11.48S35.64,32.88,35.64,39.19Z" transform="translate(-6 -2)"/>
                <path d="M31.06,39.32c0,2.31-1.19,4.2-2.64,4.23s-2.62-1.79-2.62-4.08S27,35.3,28.42,35.24,31.06,37,31.06,39.32Z" transform="translate(-6 -2)"/>
            </svg>
            <h5>Withdraw</h5>
        </div>
        <div title="Manually Send tokens" class="navbar-item" onclick="showPage(this, 'send_token')">
            <svg viewBox="0 0 72 72" class="icon">
                <title>Send token icon</title>
                <polygon points="69.65 0.8 1.33 27.53 28.06 36.45 34.01 36.45 34.01 42.39 42.92 69.12 69.65 0.8"/>
            </svg>
            <h5>Send</h5>
        </div>
        <div title="profile page" class="dropdown navbar-item"  onclick="showPage(this, 'profile_page')">
            <svg class="icon" id="profile_pic" viewBox="0 0 49.54 61.12">
                <title>User icon</title>
                <path d="M49.34,19.94c7.73,0,13.26,5.26,13.26,14S58.18,50.14,49.71,50.08,36.82,42.66,36.82,33.93s5.53-14,13.26-14" transform="translate(-25.23 -20)"/>
                <path d="M43.83,52c-2.34,4.38-9.77,6.64-15.31,9.06-2.29,1-4.11,13-1.53,13a46.06,46.06,0,0,0,23.51,6,40.48,40.48,0,0,0,22.51-6c2.58,0,.76-12-1.53-13-5.54-2.42-13-4.68-15.31-9.06" transform="translate(-25.23 -19.44)"/>
            </svg>
            <h5>Cashier</h5>
        </div>
    </nav>
    <main>
        <section id="deposit" class="page">
            <div class="container-header">
                <h2>Deposit Requests</h2>
                <div id="fetch_deposits" class="action">
                    <button>
                        Load pending
                    </button>
                    <svg viewBox="0 0 73 73" class="loader">
                        <path d="M72.5,36.5c0,19.88-16.12,36-36,36s-36-16.12-36-36s16.12-36,36-36S72.5,16.62,72.5,36.5"/>
                    </svg>
                </div>
                <label class="search" id="search_deposit">
                    <input type="search" placeholder="Search">
                </label>
            </div>
            <div id="deposit_illustration" class="empty">
                <svg viewBox="0 0 529.94 446.5">
                    <defs><style>.a,.b,.c,.d{fill:none;stroke-linejoin:round;}.a{stroke-width:9px;}.b,.c{stroke-width:5px;}.c{stroke-dasharray:11.94 11.94;}.d{stroke-width:3px;}</style></defs>
                    <title>Empty icon</title>
                    <polyline class="a" points="508.5 289 220.5 217 4.5 289 293.5 361 370.38 335.47 220.5 298 143.05 323.82 220.5 298 220.5 217 4.5 289 4.5 370 292.5 442 508.5 370 508.5 289 293.5 361 292.5 442"/>
                    <path class="b" d="M947.54,629.34q0-3,.05-6" transform="translate(-703.5 -300.22)"/>
                    <path class="c" d="M948.09,611.41c5.42-83.07,49.82-144.78,102.21-154.63,57.46-10.81,101.53-.27,88.07,42.61-7.82,24.88-50.89,36.71-71.95,5.86-26.87-39.37,12.95-108.88,71.46-131,17.38-6.57,37.33-14.37,53.89-30.53" transform="translate(-703.5 -300.22)"/>
                    <path class="b" d="M1195.9,339.41c1.32-1.47,2.62-3,3.88-4.58" transform="translate(-703.5 -300.22)"/>
                    <path class="d" d="M1215,324.59c-2,3.62-6.21,5.12-9.34,3.36s-4-6.11-2-9.72,5.67-3.13,8.8-1.37S1217,321,1215,324.59Z" transform="translate(-703.5 -300.22)"/>
                    <ellipse class="d" cx="1215.17" cy="310.95" rx="4.5" ry="4" transform="translate(-354.28 918.17) rotate(-60.69)"/>
                    <path class="d" d="M1231.68,321.5c1.44-1.68-3.48-3-6.84-5.84s-8.44-.9-9.87.78,1.31,2.43,4.67,5.3S1230.25,323.18,1231.68,321.5Z" transform="translate(-703.5 -300.22)"/>
                    <path class="d" d="M1197.61,302.37c.69-2.09,4.36,1.43,8.56,2.81s5.16,6.73,4.47,8.83-2.76.14-7-1.23S1196.93,304.47,1197.61,302.37Z" transform="translate(-703.5 -300.22)"/>
                </svg>
                <h2 class="light-text">No deposit requests.</h2>
            </div>
            <div id="deposit_request_container">
            </div>
        </section>
        <section id="withdraw" class="page hide-completely">
            <div class="container-header">
                <h2>Withdraw Requests</h2>
                <div id="fetch_withdraws" class="action">
                    <button>
                        Load pending
                    </button>
                    <svg viewBox="0 0 73 73" class="loader">
                        <path d="M72.5,36.5c0,19.88-16.12,36-36,36s-36-16.12-36-36s16.12-36,36-36S72.5,16.62,72.5,36.5"/>
                    </svg>
                </div>
                <label class="search" id="search_withdraw">
                    <input type="search" placeholder="Search">
                </label>
            </div>
            <div id="withdraw_illustration" class="empty">
                <svg viewBox="0 0 529.94 446.5">
                    <defs><style>.a,.b,.c,.d{fill:none;stroke-linejoin:round;}.a{stroke-width:9px;}.b,.c{stroke-width:5px;}.c{stroke-dasharray:11.94 11.94;}.d{stroke-width:3px;}</style></defs>
                    <title>Empty icon</title>
                    <polyline class="a" points="508.5 289 220.5 217 4.5 289 293.5 361 370.38 335.47 220.5 298 143.05 323.82 220.5 298 220.5 217 4.5 289 4.5 370 292.5 442 508.5 370 508.5 289 293.5 361 292.5 442"/>
                    <path class="b" d="M947.54,629.34q0-3,.05-6" transform="translate(-703.5 -300.22)"/>
                    <path class="c" d="M948.09,611.41c5.42-83.07,49.82-144.78,102.21-154.63,57.46-10.81,101.53-.27,88.07,42.61-7.82,24.88-50.89,36.71-71.95,5.86-26.87-39.37,12.95-108.88,71.46-131,17.38-6.57,37.33-14.37,53.89-30.53" transform="translate(-703.5 -300.22)"/>
                    <path class="b" d="M1195.9,339.41c1.32-1.47,2.62-3,3.88-4.58" transform="translate(-703.5 -300.22)"/>
                    <path class="d" d="M1215,324.59c-2,3.62-6.21,5.12-9.34,3.36s-4-6.11-2-9.72,5.67-3.13,8.8-1.37S1217,321,1215,324.59Z" transform="translate(-703.5 -300.22)"/>
                    <ellipse class="d" cx="1215.17" cy="310.95" rx="4.5" ry="4" transform="translate(-354.28 918.17) rotate(-60.69)"/>
                    <path class="d" d="M1231.68,321.5c1.44-1.68-3.48-3-6.84-5.84s-8.44-.9-9.87.78,1.31,2.43,4.67,5.3S1230.25,323.18,1231.68,321.5Z" transform="translate(-703.5 -300.22)"/>
                    <path class="d" d="M1197.61,302.37c.69-2.09,4.36,1.43,8.56,2.81s5.16,6.73,4.47,8.83-2.76.14-7-1.23S1196.93,304.47,1197.61,302.37Z" transform="translate(-703.5 -300.22)"/>
                </svg>
                <h2 class="light-text">No withdraw requests.</h2>
            </div>
            <div id="withdraw_request_container">
            </div>
        </section>
        <section id="send_token" class="page hide-completely">
            <div class="container-header">
                <h2>Manual Token Transfer</h2>
            </div>
            <form autocomplete="off" onsubmit="return false">
                <div class="input">
                    <input id="token_reciever" type="text" required>
                    <label for="token_reciever">Reciever FLO ID</label>
                </div>
                <div class="input">
                    <input id="token_amount" inputmode="numeric" type="number" required>
                    <label for="token_amount">Amount</label>
                </div>
                <div id="send-tokens_btn" class="action top-margin expand">
                    <button class="primary-btn expand" type="button" disabled>
                        Send
                    </button>
                    <svg viewBox="0 0 73 73" class="loader">
                        <path d="M72.5,36.5c0,19.88-16.12,36-36,36s-36-16.12-36-36s16.12-36,36-36S72.5,16.62,72.5,36.5"/>
                    </svg>
                </div>
            </form>
        </section>
        <section id="profile_page" class="page hide-completely">
            <div class="container-header">
                <h2>Profile</h2>
            </div>
            <h5>FLO ID</h5>
            <h4>FPFeL5PXzW9bGosUjQYCxTHSMHidnygvvd</h4>
            <button class="primary-btn top-margin" onclick="signOut()">Sign out</button>
        </section>
    </main>
    <script id="ui_functions">
        let frag = document.createDocumentFragment(),
            currentTimeout,
            notificationSound = document.getElementById('notification_sound');
        const render = {
          // returns an order element;
            depositRequest: function(txid, upiId, floId, currency, amount){
                let card = document.createElement('div'), currencySymbol;
                card.classList.add('request')
                currency === 'INR' ? currencySymbol = '₹' : currencySymbol = '$'; 
                card.innerHTML = `  <h5>UPI ID</h5>
                                    <h3 class="breakable">${upiId}</h3>
                                    <h5>FLO ID</h5>
                                    <h3 class="breakable">${floId}</h3>
                                    <h5>Amount</h5>
                                    <h3>${currencySymbol}${amount}</h3>
                                    <div id="" class="action confirm-deposit-btn">
                                        <button class="primary-btn">
                                            Confirm
                                        </button>
                                        <svg viewBox="0 0 73 73" class="loader">
                                            <path d="M72.5,36.5c0,19.88-16.12,36-36,36s-36-16.12-36-36s16.12-36,36-36S72.5,16.62,72.5,36.5"/>
                                        </svg>
                                    </div>`;
                return card;
            },
            withdrawRequest: function(txid, upiId, floId, currency, amount){
                let card = document.createElement('div'), currencySymbol;
                card.classList.add('request')
                currency === 'INR' ? currencySymbol = '₹' : currencySymbol = '$'; 
                card.innerHTML = `  <h5>UPI ID</h5>
                                    <h3 class="breakable">${upiId}</h3>
                                    <h5>FLO ID</h5>
                                    <h3 class="breakable">${floId}</h3>
                                    <h5>Amount</h5>
                                    <h3>${currencySymbol}${amount}</h3>
                                    <h5>Transaction ID</h5>
                                    <h3 class="breakable">${txid}</h3>
                                    <div id="" class="action confirm-withdraw-btn">
                                        <button class="primary-btn">
                                            Confirm
                                        </button>
                                        <svg viewBox="0 0 73 73" class="loader">
                                            <path d="M72.5,36.5c0,19.88-16.12,36-36,36s-36-16.12-36-36s16.12-36,36-36S72.5,16.62,72.5,36.5"/>
                                        </svg>
                                    </div>`;
                return card;
            },
        }

        //Checks for internet connection status
            if(!navigator.onLine) 
                showMessage('error', 'There seems to be a problem connecting to the internet.', 'fixed')
            window.addEventListener('offline', () =>{
                showMessage('error', 'There seems to be a problem connecting to the internet.', 'fixed')
            })
            window.addEventListener('online', () =>{
                showMessage('', 'We are back online.')
            }) 
            // function required for popups or modals to appear
            function showPopup(popup, permission){ 
                let thisPopup = document.getElementById(popup);
                thisPopup.parentNode.classList.remove('hide');    
                thisPopup.classList.add('no-transformations');    
                window.onmousedown = function(event) {
                    if (event.target == thisPopup.parentNode && permission !== 'no')
                        hidePopup(popup, permission);
                }
            }

            // hides the popup or modal 
            function hidePopup(pop, permission){
                let popup;
                typeof pop === 'string' ? popup = document.getElementById(pop) : popup = pop.closest('.popup');
                if(permission === 'no') return;
                popup.closest('.popup-container').classList.add('hide');    
                popup.closest('.popup').classList.remove('no-transformations'); 
                setTimeout(() => {
                    clearAllInputs(popup) 
                    if(popup.querySelector('.btn')){
                        popup.querySelector('.btn').classList.remove('clip')
                        popup.querySelector('.loader').classList.remove('animate-loader')
                        popup.querySelector(".action button").disabled = true;
                    }
                }, 400)
            }

            function setAttributes(el, attrs) {
                for(var key in attrs) {
                    el.setAttribute(key, attrs[key]);
                }
            }

            function clearAllInputs(parent){
                parent.querySelectorAll("input").forEach((field) => {
                  if(field.getAttribute('type') !== 'radio'){
                    field.value = '';
                    if(field.closest('.input'))
                      {
                        field.closest('.input').classList.remove('animate-label')
                      }
                  }
                  else
                      field.checked = false
                })
            }

            //Function for displaying toast notifications. pass in error for mode param if you want to show an error.
            function showMessage(mode, message, behavior){
                let banner = document.getElementById('show_message'),
                    back;
                if(mode === 'error'){
                  banner.querySelector('#error_icon').classList.remove('hide-completely')
                  banner.querySelector('#done_icon').classList.add('hide-completely')
                } 
                else{
                  banner.querySelector('#error_icon').classList.add('hide-completely')
                  banner.querySelector('#done_icon').classList.remove('hide-completely')
                }
                    
                banner.style.background = back;
                banner.classList.add('no-transformations')
                banner.classList.remove('hide')
                banner.querySelector('#notification_text').textContent = message.charAt(0).toUpperCase() + message.slice(1);
                if(navigator.onLine)
                  notificationSound.play();
                banner.querySelector('#hide_banner_btn').onclick = function() {
                    banner.classList.add('hide')
                    banner.classList.remove('no-transformations')
                }
                clearTimeout(currentTimeout)
                if(behavior === 'fixed') return;
                currentTimeout = setTimeout(()=>{
                    banner.classList.add('hide')
                    banner.classList.remove('no-transformations')
                }, 4000)
            }

            // displays a popup for asking permission. Use this instead of JS confirm
            let askConfirmation = function(message){
                return new Promise((resolve, reject) => {
                    let popup = document.getElementById('confirmation');
                    showPopup('confirmation')
                    popup.children[0].textContent = message;
                    popup.children[1].firstElementChild.onclick = function() {
                        hidePopup('confirmation')
                        resolve(false)
                    }
                    popup.children[1].children[1].onclick = function() {
                        hidePopup('confirmation')
                        resolve(true);
                    }
                })
            }
            function enableBtn(btn){
                if(typeof btn === 'string')
                    btn = document.getElementById(btn);
                if(btn.disabled)
                    btn.disabled = false;
            }

            function disableBtn(btn){
                if(typeof btn === 'string')
                    btn = document.getElementById(btn);
                if(!btn.disabled)
                    btn.disabled = true;
            }
            function btnLoading(btn, option){
            if(typeof btn === 'string')
                btn = document.getElementById(btn);
            if(option === 'start'){
                btn.children[0].classList.add('clip')
                btn.children[1].classList.add('animate-loader')
            }
            else{
                btn.children[0].classList.remove('clip')
                btn.children[1].classList.remove('animate-loader')
            }
        }

        // prevents non numerical input on firefox 
        function preventNonNumericalInput(e) {
            e = e || window.event;
            let charCode = (typeof e.which == "undefined") ? e.keyCode : e.which,
                charStr = String.fromCharCode(charCode);

            if (!charStr.match(/^\d+$/))
                e.preventDefault();
        }

        function areInputsEmpty(parent){
          let allInputs = parent.querySelectorAll(".input input"),
              allRadios = parent.querySelectorAll("input[type='radio']"),
              radioStatus, inputStatus, counter = 0;
          inputStatus = [...allInputs].every(input => input.checkValidity())
          
          allRadios.forEach(radio => {
            if(radio.checked)
              counter++;
          })
          if(counter == allRadios.length/2)
            radioStatus = true;
          if(inputStatus && radioStatus)
            return true
          else false
        }

        function formValidation(formElement, e){ 
          if(formElement.getAttribute('type') === 'number')
            preventNonNumericalInput(e);
          let parent = formElement.closest('form'), 
              submitBtn = parent.querySelector(".action button");
          if(areInputsEmpty(parent))
            submitBtn.disabled = false;
          else
            submitBtn.disabled = true;
        }

        let allForms = document.querySelectorAll('form');
        window.addEventListener('load', ()=> {
            allForms.forEach((form) => {
                form.addEventListener('keyup', (e) => {
                    if(e.target.closest('.input')){
                        let parent = e.target.closest('.input');
                        if(parent.firstElementChild.value !== '')
                            parent.classList.add('animate-label')
                        else 
                            parent.classList.remove('animate-label')
                        formValidation(parent.firstElementChild, e)
                        if(e.key === 'Enter'){
                            parent.closest('form').querySelector(".action").click();
                        }
                    }
                })
            })
            allForms.forEach((form) => {
                form.addEventListener('blur', (e) => {
                    if(e.target.closest('.input')){
                        let parent = e.target.closest('.input');
                    if(parent.firstElementChild.value === '')
                        parent.classList.remove('animate-label')
                    }
                }, true)
            })

            // Function for confirming deposit requests 
            document.getElementById('deposit_request_container').addEventListener('click', (e) => {
                let container = document.getElementById('deposit_request_container');
                if(e.target.closest('.confirm-deposit-btn'))
                    askConfirmation('Confirm this deposit request?').then((result) => {
                        if(result){
                          let depositRequestId = e.target.closest('.confirm-deposit-btn').id;
                          btnLoading(e.target.closest('.confirm-deposit-btn'), 'start')
                          setTimeout(() => {
                            e.target.closest('.request').remove();
                            showMessage('', `Request id: ${depositRequestId} confirmed.`)
                            if(container.children.length === 0)
                                document.getElementById('deposit_illustration').classList.remove('hide-completely')
                                document.getElementById('search_deposit').classList.add('hide-completely')
                          },1000)
                        }
                    })
            })

            // Function for confirming withdraw requests 
            document.getElementById('withdraw_request_container').addEventListener('click', (e) => {
                let container = document.getElementById('withdraw_request_container');
                if(e.target.closest('.confirm-withdraw-btn'))
                    askConfirmation('Confirm this withdraw request?').then((result) => {
                        if(result){
                          let withdrawRequestId = e.target.closest('.confirm-withdraw-btn').id;
                          btnLoading(e.target.closest('.confirm-withdraw-btn'), 'start')
                          setTimeout(() => {
                            e.target.closest('.request').remove();
                            showMessage('', `Request id: ${withdrawRequestId} confirmed.`)
                            if(container.children.length === 0){
                                document.getElementById('withdraw_illustration').classList.remove('hide-completely')
                                document.getElementById('search_withdraw').classList.add('hide-completely')
                            } 
                          },1000)
                        }
                    })
            })

            //renders deposit requests
            document.getElementById('deposit_request_container').innerHTML = '';
            for(let i = 0; i < 6; i++){
                frag.append(render.depositRequest('s6f5h4s65f4h6s5465s4', '7744023898@paytm', 'FPFeL5PXzW9bGosUjQYCxTHSMHidnygvvd', 'INR', '50000'))
            }
            if(frag.children.length === 0){
                document.getElementById('deposit_illustration').classList.remove('hide-completely')
                document.getElementById('search_deposit').classList.add('hide-completely')
            }
            else{
                document.getElementById('search_withdraw').classList.remove('hide-completely')
                document.getElementById('deposit_illustration').classList.add('hide-completely')
            }
            document.getElementById('deposit_request_container').append(frag);
            
            //renders deposit requests
            document.getElementById('withdraw_request_container').innerHTML = '';
            for(let i = 0; i < 0; i++){
                frag.append(render.withdrawRequest('s6f5h4s65f4h6s5465s4kdvbskjbvjasbdvbadbvjabdjvajdbksvjbskjb', '7744023898@paytm', 'FPFeL5PXzW9bGosUjQYCxTHSMHidnygvvd', 'INR', '50000'))
            }
            if(frag.children.length === 0){
                document.getElementById('withdraw_request_container').innerHTML = ``;
                document.getElementById('search_withdraw').classList.add('hide-completely')
            }
            else{
                document.getElementById('search_withdraw').classList.remove('hide-completely')
                document.getElementById('withdraw_illustration').classList.add('hide-completely')
            }

            document.getElementById('withdraw_request_container').append(frag);
        })

        let allPages = document.querySelectorAll('.page'),
            allTabs = document.querySelectorAll('.navbar-item');
        function showPage(btn, page){
            let thisBtn;
            typeof btn === 'string' ? thisbtn = document.getElementById(btn) : thisBtn = btn; 
            allPages.forEach((page) => {
                page.classList.add('hide-completely')
            })
            allTabs.forEach((tab) => {
                tab.classList.remove('active')
            })
            document.getElementById(page).classList.remove('hide-completely')
            thisBtn.classList.add('active', 'shrink')
            if(page === 'send_token')
            {
                document.getElementById('deposit_page_btn').classList.remove('shrink')
            }
        }

        // exchange execute option functions

        function buyCrypto(btn){
          let parentPopup = btn.closest('.popup'),
              selectedCrypto = parentPopup.querySelector("input[name='crypto']:checked").value,
              selectedCurrency = parentPopup.querySelector("input[name='currency']:checked").value,
              buyWorth = parentPopup.querySelector('.input input').value;
          console.log(selectedCrypto, selectedCurrency, buyWorth)
          btnLoading(btn, 'start')  
          
          //if operation completes{
            setTimeout(() => {
              btnLoading(btn, 'stop')
              hidePopup(parentPopup)
              showMessage('', 'Bought Crypto')
            }, 1000)
          //}
          /*else{
              showMessage('error', 'Error message')
          }*/
        }
        

        function signIn(btn){
          let parentPopup = btn.closest('form');
          btnLoading(btn, 'start')  
          
          //if operation completes{
            setTimeout(() => {
              btnLoading(btn, 'stop')
              hidePopup(parentPopup)
              showMessage('', 'Signed In')
              document.querySelector('main').classList.remove('hide-completely')
            }, 1000)
          //}
        }

        function signOut(){
            askConfirmation('Do you want to sign out?').then((result) => {
                if(result){
                    showMessage('', 'Signed out')
                    document.querySelector('main').classList.add('hide-completely')
                    showPopup('sign_in_popup')
                }
            })
        }
    </script>
</body>
</html>